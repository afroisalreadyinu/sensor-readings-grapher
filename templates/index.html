<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><title>Reading graphs</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script>
    var REDRAW_EVERY = 10; //seconds
    var graphit = function(data) {
      $('#container').highcharts({
        title: {
            text: 'Sensor readings',
            x: -20 //center
        },
        xAxis: {
            categories: data.categories,
            labels: {
                rotation: 90
            }
        },
        yAxis: {
            title: {
                text: 'Temperature (°C)'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            valueSuffix: '°C'
        },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
        },
        series: data.series
    });
    };
  $(function () {
    var draw = function() {
      $.get("/read", function(data) { graphit(data); });
      setTimeout(draw, REDRAW_EVERY*1000);
    };
    draw();
  });
</script>
</head>
  <body>
    <h1>Power usage over time</h1>
    <div id="container" style="width:100%; height:600px;"></div>
  </body>
</html>
